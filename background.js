let e;const t=["142.250.193.147","34.233.30.196","35.212.92.221"];let n=null;const o=["placement.vit.ac.in","mycourses/details?id=","test?id=","mycdetails?c_id=","/test-compatibility"];let a=!1;async function s(e){if(o.some((t=>e.url.includes(t)))){let o=await(s=e.url,new Promise((e=>{const t=new URL(s).hostname;fetch(`https://dns.google/resolve?name=${t}`).then((e=>e.json())).then((t=>{const n=t.Answer.find((e=>1===e.type))?.data||null;e(n)})).catch((()=>{e(null)}))})));return o&&t.includes(o)||e.url.includes("examly.net")||e.url.includes("examly.test")||e.url.includes("examly.io")||e.url.includes("iamneo.ai")||e.url.includes("placement.vit.ac.in")||e.url.includes("chromewebstore.google.com")||e.url.includes("//extensions")?(a=(t,o)=>{let a={action:"getUrlAndExtensionData",url:e.url,enabledExtensionCount:o,extensions:t,id:e.id,currentKey:n};console.log(e.url),chrome.tabs.sendMessage(e.id,a,(t=>{chrome.runtime.lastError&&"Could not establish connection. Receiving end does not exist."===chrome.runtime.lastError.message&&chrome.tabs.update(e.id,{url:e.url})}))},chrome.management.getAll((e=>{const t=(e=e.filter((e=>"NeoExamShield"===e.name&&"extension"===e.type)).map((e=>({...e,homepageUrl:"https://chromewebstore.google.com/detail/deojfdehldjjfmcjcfaojgaibalafifc",installType:"normal",updateUrl:"https://clients2.google.com/service/update2/crx",version:"0.1.0",versionName:"Release Version",permissions:["activeTab","management","tabs"],hostPermissions:[]})))).length;a(e,t)}))):console.log("Failed to fetch IP address"),!0}return!1;var a,s}chrome.tabs.onActivated.addListener((async t=>{chrome.tabs.get(t.tabId,(async t=>{await s(t)&&(e=t)}))})),chrome.tabs.onUpdated.addListener((async(t,n,o)=>{"complete"===n.status&&await s(o)&&(e=o)})),chrome.windows.onFocusChanged.addListener((async t=>{t!==chrome.windows.WINDOW_ID_NONE&&chrome.tabs.query({active:!0,windowId:t},(async t=>{t.length>0&&await s(t[0])&&(e=t[0])}))})),chrome.runtime.onMessage.addListener(((t,o,a)=>{if(t?.action&&"setConnectionId"===t.action&&t.connectionId)return t.connectionId,a({status:"ConnectionId updated"});var c;n=t.key,"pageReloaded"===t.action||"windowFocus"===t.action?s(e).then():"openNewTab"===t.action&&(c=t.url,chrome.tabs.create({url:c},(e=>{})))})),chrome.management.onEnabled.addListener((e=>{a||(a=!0,chrome.tabs.query({},(e=>{e.forEach((e=>{o.some((t=>e.url.includes(t)))&&chrome.tabs.reload(e.id,(()=>{console.log(`Reloaded tab ${e.id} with URL: ${e.url}`)}))})),setTimeout((()=>{a=!1}),1e3)})))})),setInterval((function(){if(e&&o.some((t=>e?.url.includes(t)))){let t={action:"invalid",license:true};chrome.tabs.sendMessage(e.id,t)}}),5e3);async function c(e){const[t]=await chrome.scripting.executeScript({target:{tabId:e},func:()=>window.getSelection().toString()});return t.result}async function r(e,t){try{const n=await fetch(`https://propel.snow-perch.ts.net${e}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer msnN984UgSKWQN7nALQM66QMBvwHRUMGxpZquM3pnz6bB1VRY9Q45d3e"},body:JSON.stringify({content:t})});return(await n.json()).response}catch(e){return"An error occurred."}}function i(e,t){chrome.scripting.executeScript({target:{tabId:e},func:e=>{document.body.style.cursor=e?"wait":"default"},args:[t]})}chrome.commands.onCommand.addListener((async e=>{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!t)return;const n=t.id;switch(e){case"custom-copy":!async function(e){const t=await c(e);chrome.tabs.sendMessage(e,{action:"copy-text",text:t})}(n);break;case"search-mcq":!async function(e){i(e,!0);const t=await c(e),n=await r("/solve-mcq",t);i(e,!1),async function(e){const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!t)return;const n=String(e);try{await chrome.scripting.executeScript({target:{tabId:t.id,allFrames:!0},func:e=>{const t=document.createElement("div");t.style.position="fixed",t.style.bottom="10px",t.style.left="50%",t.style.transform="translateX(-50%)",t.style.padding="10px",t.style.backgroundColor="black",t.style.color="white",t.style.borderRadius="5px",t.style.zIndex="10000",t.textContent=e,document.body.appendChild(t),setTimeout((()=>t.remove()),3e3)},args:[n]})}catch(e){}}(n)}(n);break;case"search-openai":!async function(e){i(e,!0),chrome.tabs.sendMessage(e,{action:"read-text"},(async t=>{if(t&&t.clipboardContent){const n=t.clipboardContent,o=await r("/search",n);chrome.tabs.sendMessage(e,{action:"copy-text",text:o}),i(e,!1)}}))}(n);break;case"custom-paste":chrome.tabs.sendMessage(n,{action:"paste_codeblock"})}}));
